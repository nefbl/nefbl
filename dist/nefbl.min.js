/*!
 * nefbl - Êñ∞‰∏Ä‰ª£ÂâçÁ´ØÊ°ÜÊû∂
 *
 * git+https://github.com/nefbl/nefbl.git
 *
 * author ‰Ω†Â•Ω2007 < https://hai2007.gitee.io/sweethome >
 *
 * version 0.1.4
 *
 * Copyright (c) 2021-2021 hai2007 Ëµ∞‰∏ÄÊ≠•ÔºåÂÜçËµ∞‰∏ÄÊ≠•„ÄÇ
 * Released under the MIT license
 *
 * Date:Mon Oct 04 2021 13:17:27 GMT+0800 (‰∏≠ÂõΩÊ†áÂáÜÊó∂Èó¥)
 */
(function(){"use strict";function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function(obj){return typeof obj}}else{_typeof=function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread2(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function(){};return{s:F,n:function(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();normalCompletion=step.done;return step},e:function(e){didErr=true;err=e},f:function(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _isObject(value){var type=_typeof(value);return value!=null&&(type==="object"||type==="function")}var toString=Object.prototype.toString;function getType(value){if(value==null){return value===undefined?"[object Undefined]":"[object Null]"}return toString.call(value)}function _isString(value){var type=_typeof(value);return type==="string"||type==="object"&&value!=null&&!Array.isArray(value)&&getType(value)==="[object String]"}function _isFunction(value){if(!_isObject(value)){return false}var type=getType(value);return type==="[object Function]"||type==="[object AsyncFunction]"||type==="[object GeneratorFunction]"||type==="[object Proxy]"}
/*!
   * üí° - ÂÄºÁ±ªÂûãÂà§Êñ≠ÊñπÊ≥ï
   * https://github.com/hai2007/tool.js/blob/master/type.js
   *
   * author hai2007 < https://hai2007.gitee.io/sweethome >
   *
   * Copyright (c) 2020-present hai2007 Ëµ∞‰∏ÄÊ≠•ÔºåÂÜçËµ∞‰∏ÄÊ≠•„ÄÇ
   * Released under the MIT license
   */var isObject=_isObject;var isString=_isString;var isFunction=_isFunction;var isArray=function isArray(input){return Array.isArray(input)};function Module(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var component={},directive={};var bootstrapComponent=null;var exports={component:{},directive:{}};if(isArray(config.declarations)){var _iterator=_createForOfIteratorHelper(config.declarations),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var Item=_step.value;var needExports=false;if(isArray(config.exports)){var _iterator2=_createForOfIteratorHelper(config.exports),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var ExportItem=_step2.value;if(ExportItem===Item){needExports=true;break}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}if(Item.prototype.__type__=="Component"){component[Item.prototype.__selector__]=Item;if(config.bootstrap===Item){bootstrapComponent=Item}if(needExports){exports.component[Item.prototype.__selector__]=Item}}else if(Item.prototype.__type__=="Directive"){directive[Item.prototype.__selector__]=Item;if(needExports){exports.directive[Item.prototype.__selector__]=Item}}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}if(isArray(config.imports)){var _iterator3=_createForOfIteratorHelper(config.imports),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var module=_step3.value;for(var key in module.prototype.__exports__.component){component[key]=module.prototype.__exports__.component[key]}for(var _key in module.prototype.__exports__.directive){directive[_key]=module.prototype.__exports__.directive[_key]}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}return function(target){target.prototype.__type__="Module";target.prototype.__component__=component;target.prototype.__directive__=directive;target.prototype.__exports__=exports;target.prototype.__bootstrapComponent__=bootstrapComponent}}var $RegExp={blankReg:new RegExp("[\\x20\\t\\r\\n\\f]"),blanksReg:/^[\x20\t\r\n\f]{0,}$/,identifier:/^[a-zA-Z_$][0-9a-zA-Z_$]{0,}$/};function analyseTag(attrString){var attr={},index=0;attrString=attrString.trim();var getOneAttr=function getOneAttr(){var attrName="",attrValue="";for(;index<attrString.length;index++){if($RegExp.blanksReg.test(attrString[index])||index==attrString.length-1){attrName+=attrString[index];if(!$RegExp.blanksReg.test(attrName)){attr[attrName.trim()]=""}index+=1;break}else if(attrString[index]=="="){index+=1;var preCode=null,preLeng=-1;if(attrString.substr(index,1)=='"'||attrString.substr(index,1)=="'"){preCode=attrString.substr(index,1);preLeng=1;index+=1}else if(attrString.substr(index,2)=='"'||attrString.substr(index,2)=="'"){preCode=attrString.substr(index,2);preLeng=2;index+=2}if(preCode!==null){for(;index<attrString.length;index++){if(attrString.substr(index,preLeng)==preCode){attr[attrName.trim()]=attrValue.trim();index+=2;break}else{attrValue+=attrString[index]}}}else{for(;index<attrString.length;index++){if($RegExp.blanksReg.test(attrString[index])){attr[attrName.trim()]=attrValue.trim();index+=1;break}else{attrValue+=attrString[index]}}}break}else{attrName+=attrString[index]}}if(index<attrString.length){getOneAttr()}};getOneAttr();return attr}function nextTagFun(template){var i=-1,currentChar=null;var preIsSpecial=false,specialCode="";var specialTag=["script","pre","style","code"];var next=function next(){currentChar=i++<template.length-1?template[i]:null;return currentChar};var nextNValue=function nextNValue(n){return template.substring(i,n+i>template.length?template.length:n+i)};next();while($RegExp.blankReg.test(currentChar)&&i<template.length-1){next()}return function(){var tag=currentChar,tagObj={};if(tag==null)return null;if(preIsSpecial){tagObj.type="textcode";tagObj.tagName=tag;while(nextNValue(specialCode.length+3)!="</"+specialCode+">"&&i<template.length){tagObj.tagName+=next()}tagObj.tagName=tagObj.tagName.replace(/<$/,"");preIsSpecial=false;return tagObj}if(nextNValue(4)=="\x3c!--"){tagObj.type="comment";tagObj.tagName=tag;while(nextNValue(3)!="--\x3e"&&i<template.length){tagObj.tagName+=next()}next();next();next();tagObj.tagName=tagObj.tagName.replace(/^<!--/,"").replace(/-$/,"");return tagObj}if(nextNValue(9)=="<!DOCTYPE"){tagObj.type="DOCTYPE";tagObj.tagName=tag;while(nextNValue(1)!=">"&&i<template.length){tagObj.tagName+=next()}next();tagObj.tagName=tagObj.tagName.replace(/^<!DOCTYPE/,"").replace(/>$/,"");return tagObj}else if(tag=="<"){var isAttrString=false,attrLeftValue=null,attrLeftLen=null;while((isAttrString||currentChar!=">")&&i<template.length){tag+=next();if(isAttrString){var next23Value=nextNValue(attrLeftLen+1).substring(1);if(next23Value==attrLeftValue){isAttrString=false}}else{var next23Value=nextNValue(2);if(next23Value=='="'||next23Value=="='"){attrLeftValue=next23Value.replace("=","");attrLeftLen=1;isAttrString=true}next23Value=nextNValue(3);if(next23Value=='="'||next23Value=="='"){attrLeftValue=next23Value.replace("=","");attrLeftLen=2;isAttrString=true}}}if(/^<\//.test(tag)){tagObj.tagName=tag.replace(/^<\//,"").replace(/>$/,"");tagObj.type="endTag"}else{if(/\/>$/.test(tag)){tagObj.type="fullTag";tag=tag.replace(/\/>$/,"")}else{tagObj.type="beginTag";tag=tag.replace(/>$/,"")}tag=tag.replace(/^</,"");tagObj.tagName="";var j=0;for(;j<tag.length;j++){if(tag[j]==" ")break;tagObj.tagName+=tag[j]}var attrString=tag.substring(j);if($RegExp.blanksReg.test(attrString)){tagObj.attrs={}}else{tagObj.attrs=analyseTag(attrString)}}}else{tagObj.type="textcode";tagObj.tagName=currentChar;while(nextNValue(1)!="<"&&i<template.length){tagObj.tagName+=next()}tagObj.tagName=tagObj.tagName.replace(/<$/,"");i-=1}if(tagObj.type=="beginTag"){if(specialTag.indexOf(tagObj.tagName.toLowerCase())>-1){preIsSpecial=true;specialCode=tagObj.tagName}}else if(tagObj.type=="endTag"){if(specialTag.indexOf(tagObj.tagName.toLowerCase())>-1){preIsSpecial=false}}next();return tagObj}}function analyseDeep(tagArray){tagArray=closeTag(tagArray);var deep=0,tagDeepArray=[];tagArray.forEach((function(tag){if(tag.type=="beginTag"){tagDeepArray.push({type:"tag",name:tag.tagName,attrs:tag.attrs,__deep__:++deep,__tagType__:"double"})}else if(tag.type=="endTag"){deep-=1}else if(tag.type=="textcode"){tagDeepArray.push({type:"text",content:tag.tagName,__deep__:deep+1})}else if(tag.type=="comment"){tagDeepArray.push({type:"comment",content:tag.tagName,__deep__:deep+1})}else{tagDeepArray.push({type:"tag",name:tag.tagName,attrs:tag.attrs,__deep__:deep+1,__tagType__:"single"})}}));return tagDeepArray}var closeTag=function closeTag(tagArray){var needClose=[];tagArray.forEach((function(tag,i){if(tag.type=="beginTag"){needClose.push([i,tag.tagName])}else if(tag.type=="endTag"){while(needClose.length>0){var needCloseTag=needClose.pop();if(needCloseTag[1]==tag.tagName){break}else{tagArray[needCloseTag[0]].type="fullTag"}}}}));return tagArray};
/*!
   * üî™ - Ëß£Êûêxhtml‰∏∫jsonÂØπË±°ËøîÂõû
   * https://github.com/hai2007/algorithm.js/blob/master/xhtmlToJson.js
   *
   * author hai2007 < https://hai2007.gitee.io/sweethome >
   *
   * Copyright (c) 2020-present hai2007 Ëµ∞‰∏ÄÊ≠•ÔºåÂÜçËµ∞‰∏ÄÊ≠•„ÄÇ
   * Released under the MIT license
   */function xhtmlToJson(template,noIgnore){if(!isString(template))throw new Error("Template must be a String!");var nextTag=nextTagFun(template.trim());var tag=nextTag(),DomTree=[];while(tag!=null){if(tag.type=="textcode"&&$RegExp.blanksReg.test(tag.tagName));else if(tag.type=="DOCTYPE");else if(tag.type=="comment"){if(noIgnore){DomTree.push(tag)}}else{DomTree.push(tag)}tag=nextTag()}DomTree=analyseDeep(DomTree);var presNode=[null],preDeep=0;for(var i=0;i<DomTree.length;i++){var currentIndex=i,currentDeep=DomTree[i].__deep__;DomTree[i].childNodes=[];DomTree[i].preNode=null;DomTree[i].nextNode=null;var lastPre=presNode[presNode.length-1];var last2Pre=presNode.length>1?presNode[presNode.length-2]:null;if(currentDeep==preDeep){DomTree[currentIndex].preNode=lastPre;DomTree[lastPre].nextNode=currentIndex;DomTree[currentIndex].parentNode=last2Pre;DomTree[last2Pre].childNodes.push(currentIndex);presNode[presNode.length-1]=currentIndex}else if(currentDeep>preDeep){DomTree[currentIndex].parentNode=lastPre;if(lastPre!=null)DomTree[lastPre].childNodes.push(currentIndex);presNode.push(currentIndex)}else{var preTempIndex=presNode[presNode.length-1-(preDeep-currentDeep)];var preTemp2Index=presNode[presNode.length-2-(preDeep-currentDeep)];DomTree[currentIndex].preNode=preTempIndex;if(preTempIndex!=null)DomTree[preTempIndex].nextNode=currentIndex;DomTree[currentIndex].parentNode=preTemp2Index;if(preTemp2Index!=null)DomTree[preTemp2Index].childNodes.push(currentIndex);for(var j=0;j<preDeep-currentDeep;j++){presNode.pop()}presNode[presNode.length-1]=currentIndex}preDeep=currentDeep}return DomTree}function addStylesClient(styles,uniqueId){var styleElement=document.createElement("style");var head=document.head||document.getElementsByTagName("head")[0];var style=styles.join("");if(uniqueId){style=style.replace(/( {0,}){/g,"{");style=style.replace(/( {0,}),/g,",");var temp="";var isSpecial=false,isContent=false,hadComplete=false;for(var i=0;i<style.length;i++){if(style[i]==":"&&!isSpecial&&!hadComplete&&!isContent){hadComplete=true;temp+="["+uniqueId+"]"}else if(style[i]=="{"&&!isSpecial){isContent=true;if(!hadComplete)temp+="["+uniqueId+"]"}else if(style[i]=="}"&&!isSpecial){isContent=false;hadComplete=false}else if(style[i]=="/"&&style[i+1]=="*"){isSpecial=true}else if(style[i]=="*"&&style[i+1]=="/"){isSpecial=false}else if(style[i]==","&&!isSpecial&&!isContent){if(!hadComplete)temp+="["+uniqueId+"]";hadComplete=false}temp+=style[i]}style=temp}styleElement.innerHTML=style;styleElement.setAttribute("type","text/css");head.appendChild(styleElement)}var index=0;function Component(config){var uniqueId=null;if(isArray(config.styles)){uniqueId="nefbl-scoped-"+index++;addStylesClient(config.styles,uniqueId)}var template=xhtmlToJson("<nefbl-component>"+config.template+"</nefbl-component>");return function(target){target.prototype.__type__="Component";target.prototype.__selector__=config.selector;target.prototype.__template__=template;target.prototype.__uniqueId__=uniqueId}}function Directive(config){return function(target){target.prototype.__type__="Directive";target.prototype.__selector__=config.selector}}function isValidKey(key){if(/^[_$]/.test(key)){throw new Error("The beginning of _ or $ is not allowedÔºö"+key)}}function watcher(component,data,key,doback){var value=data.value;var getter_setter={get:function get(){return value},set:function set(newValue){value=newValue;doback()}};Object.defineProperty(data,"value",getter_setter);component[key]=value;Object.defineProperty(component,key,getter_setter)}function proxy(component,data,key,doback){var proxy=new Proxy(data.value,{get:function get(_target,_key){return _target[_key]},set:function set(_target,_key,_value){doback();return Reflect.set(_target,_key,_value)}});data.value=proxy;component[key]=proxy}var specialCode1=["+","-","*","/","%","&","|","!","?",":","[","]","(",")",">","<","="];var specialCode2=["+","-","*","/","%","&","|","!","?",":",">","<","=","<=",">=","==","===","!=","!=="];function analyseExpress(target,express,scope){express=express.trim();var i=-1,currentChar=null;var next=function next(){currentChar=i++<express.length-1?express[i]:null;return currentChar};var nextNValue=function nextNValue(n){return express.substring(i,n+i>express.length?express.length:n+i)};next();var expressArray=[];while(true){if(i>=express.length)break;if(specialCode1.indexOf(currentChar)>-1){if(["&","|","="].indexOf(currentChar)>-1){if(["==="].indexOf(nextNValue(3))>-1){expressArray.push(nextNValue(3));i+=2;next()}else if(["&&","||","=="].indexOf(nextNValue(2))>-1){expressArray.push(nextNValue(2));i+=1;next()}else{throw new Error("Illegal expression : "+express+"\nstep='analyseExpress',index="+i)}}else{if(["!=="].indexOf(nextNValue(3))>-1){expressArray.push(nextNValue(3));i+=2;next()}else if([">=","<=","!="].indexOf(nextNValue(2))>-1){expressArray.push(nextNValue(2));i+=1;next()}else{expressArray.push(currentChar);next()}}}else if(['"',"'"].indexOf(currentChar)>-1){var temp="",beginTag=currentChar;next();while(currentChar!=beginTag){if(i>=express.length){throw new Error("String unclosed error : "+express+"\nstep='analyseExpress',index="+i)}temp+=currentChar;next()}expressArray.push(temp+"@string");next()}else if(/\d/.test(currentChar)){var dotFlag="no";var temp=currentChar;next();while(i<express.length){if(/\d/.test(currentChar)){temp+=currentChar;if(dotFlag=="error")dotFlag="yes"}else if("."==currentChar&&dotFlag=="no"){temp+=currentChar;dotFlag="error"}else{break}next()}if(dotFlag=="error")temp+="0";expressArray.push(+temp)}else if(["null","true"].indexOf(nextNValue(4))>-1){expressArray.push({null:null,true:true}[nextNValue(4)]);i+=3;next()}else if(["false"].indexOf(nextNValue(5))>-1){expressArray.push({false:false}[nextNValue(5)]);i+=4;next()}else if(["undefined"].indexOf(nextNValue(9))>-1){expressArray.push({undefined:undefined}[nextNValue(9)]);i+=8;next()}else if($RegExp.blankReg.test(currentChar)){do{next()}while($RegExp.blankReg.test(currentChar)&&i<express.length)}else{var dot=false;if(currentChar=="."){dot=true;next()}if($RegExp.identifier.test(currentChar)){var len=1;while(i+len<=express.length&&$RegExp.identifier.test(nextNValue(len))){len+=1}if(dot){expressArray.push("[");expressArray.push(nextNValue(len-1)+"@string");expressArray.push("]")}else{var tempKey=nextNValue(len-1);var tempValue=tempKey in scope?scope[tempKey]:target[tempKey];expressArray.push(isString(tempValue)?tempValue+"@string":tempValue)}i+=len-2;next()}else{throw new Error("Illegal express : "+express+"\nstep='analyseExpress',index="+i)}}}var length=0;for(var j=0;j<expressArray.length;j++){if(["+","-"].indexOf(expressArray[j])>-1&&(j==0||specialCode2.indexOf(expressArray[length-1])>-1)){expressArray[length++]=+(expressArray[j]+expressArray[j+1]);j+=1}else{expressArray[length++]=expressArray[j]}}expressArray.length=length;return expressArray}var getExpressValue=function getExpressValue(value){if(typeof value=="string")return value.replace(/@string$/,"");return value};var setExpressValue=function setExpressValue(value){if(typeof value=="string")return value+"@string";return value};function evalValue(expressArray){var length=0,i=0;for(;i<expressArray.length;i++){if(expressArray[i]=="!"){expressArray[length]=!expressArray[++i]}else expressArray[length]=expressArray[i];length+=1}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;length=0;for(i=0;i<expressArray.length;i++){if(expressArray[i]=="*"){expressArray[length-1]=getExpressValue(expressArray[length-1])*getExpressValue(expressArray[++i])}else if(expressArray[i]=="/"){expressArray[length-1]=getExpressValue(expressArray[length-1])/getExpressValue(expressArray[++i])}else if(expressArray[i]=="%"){expressArray[length-1]=getExpressValue(expressArray[length-1])%getExpressValue(expressArray[++i])}else{expressArray[length++]=expressArray[i]}}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;length=0;for(i=0;i<expressArray.length;i++){if(expressArray[i]=="+"){expressArray[length-1]=setExpressValue(getExpressValue(expressArray[length-1])+getExpressValue(expressArray[++i]))}else if(expressArray[i]=="-"){expressArray[length-1]=getExpressValue(expressArray[length-1])-getExpressValue(expressArray[++i])}else expressArray[length++]=expressArray[i]}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;length=0;for(i=0;i<expressArray.length;i++){if(expressArray[i]==">"){expressArray[length-1]=getExpressValue(expressArray[length-1])>getExpressValue(expressArray[++i])}else if(expressArray[i]=="<"){expressArray[length-1]=getExpressValue(expressArray[length-1])<getExpressValue(expressArray[++i])}else if(expressArray[i]=="<="){expressArray[length-1]=getExpressValue(expressArray[length-1])<=getExpressValue(expressArray[++i])}else if(expressArray[i]==">="){expressArray[length-1]=getExpressValue(expressArray[length-1])>=getExpressValue(expressArray[++i])}else expressArray[length++]=expressArray[i]}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;length=0;for(i=0;i<expressArray.length;i++){if(expressArray[i]=="=="){expressArray[length-1]=getExpressValue(expressArray[length-1])==getExpressValue(expressArray[++i])}else if(expressArray[i]=="==="){expressArray[length-1]=getExpressValue(expressArray[length-1])===getExpressValue(expressArray[++i])}else if(expressArray[i]=="!="){expressArray[length-1]=getExpressValue(expressArray[length-1])!=getExpressValue(expressArray[++i])}else if(expressArray[i]=="!=="){expressArray[length-1]=getExpressValue(expressArray[length-1])!==getExpressValue(expressArray[++i])}else expressArray[length++]=expressArray[i]}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;length=0;for(i=0;i<expressArray.length;i++){if(expressArray[i]=="&&"){expressArray[length-1]=getExpressValue(expressArray[length-1])&&getExpressValue(expressArray[1+i]);i+=1}else if(expressArray[i]=="||"){expressArray[length-1]=getExpressValue(expressArray[length-1])||getExpressValue(expressArray[1+i]);i+=1}else expressArray[length++]=expressArray[i]}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;length=0;for(i=0;i<expressArray.length;i++){if(expressArray[i]=="?"){expressArray[length-1]=getExpressValue(expressArray[length-1])?getExpressValue(expressArray[i+1]):getExpressValue(expressArray[i+3]);i+=3}else expressArray[length++]=expressArray[i]}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;throw new Error("Unrecognized expression : ["+expressArray.toString()+"]")}function calcValue(target,expressArray,scope){var value=expressArray[0]in scope?scope[expressArray[0]]:target[expressArray[0]];for(var i=1;i<expressArray.length;i++){try{value=value[expressArray[i]]}catch(e){console.error({target:target,scope:scope,expressArray:expressArray,index:i});throw e}}return value}var doit1=function doit1(target,expressArray,scope){if(expressArray.indexOf("(")>-1){var newExpressArray=[],temp=[],flag=0;for(var i=0;i<expressArray.length;i++){if(expressArray[i]=="("){if(flag>0){temp.push("(")}flag+=1}else if(expressArray[i]==")"){if(flag>1)temp.push(")");flag-=1;if(flag==0){var _value=evalValue(doit1(target,temp));newExpressArray.push(isString(_value)?_value+"@string":_value);temp=[]}}else{if(flag>0)temp.push(expressArray[i]);else newExpressArray.push(expressArray[i])}}expressArray=newExpressArray}return doit2(expressArray)};var doit2=function doit2(expressArray){var hadMore=true;while(hadMore){hadMore=false;var newExpressArray=[],temp=[],flag=false;for(var i=0;i<expressArray.length;i++){if(expressArray[i]=="["&&i!=0&&expressArray[i-1]!="]"){if(flag){newExpressArray.push("[");for(var j=0;j<temp.length;j++){newExpressArray.push(temp[j])}}else{flag=true}temp=[]}else if(expressArray[i]=="]"&&flag){hadMore=true;var tempValue=evalValue(temp);var _value=newExpressArray[newExpressArray.length-1][tempValue];newExpressArray[newExpressArray.length-1]=isString(_value)?_value+"@string":_value;flag=false}else{if(flag){temp.push(expressArray[i])}else{newExpressArray.push(expressArray[i])}}}expressArray=newExpressArray}return expressArray};var doit3=function doit3(expressArray){var newExpressArray=[],temp=[];for(var i=0;i<expressArray.length;i++){if(expressArray[i]=="["){temp=[]}else if(expressArray[i]=="]"){newExpressArray.push(evalValue(temp))}else{temp.push(expressArray[i])}}return newExpressArray};function toPath(target,expressArray,scope){var newExpressArray=doit1(target,expressArray);var path;if(newExpressArray[0]!="["){path=[evalValue(newExpressArray)]}else if(newExpressArray[newExpressArray.length-1]=="]"){path=doit3(newExpressArray)}else{var lastIndex=newExpressArray.lastIndexOf("]");var tempPath=doit3(newExpressArray.slice(0,lastIndex+1));var tempArray=newExpressArray.slice(lastIndex+1);tempArray.unshift(calcValue(target,tempPath,scope));path=[evalValue(tempArray)]}return path}
/*!
   * üî™ - ËÆæÁΩÆÊàñËé∑ÂèñÊåáÂÆöÂØπË±°‰∏äÂ≠óÁ¨¶‰∏≤Ë°®ËææÂºèÂØπÂ∫îÁöÑÂÄº
   * https://github.com/hai2007/algorithm.js/blob/master/value.js
   *
   * author hai2007 < https://hai2007.gitee.io/sweethome >
   *
   * Copyright (c) 2020-present hai2007 Ëµ∞‰∏ÄÊ≠•ÔºåÂÜçËµ∞‰∏ÄÊ≠•„ÄÇ
   * Released under the MIT license
   */var evalExpress=function evalExpress(target,express,scope){if(arguments.length<3)scope={};var expressArray=analyseExpress(target,express,scope);var path=toPath(target,expressArray,scope);if(path.length>1)throw new Error("Illegal expression : "+express+"\nstep='evalExpress',path="+path+",expressArray="+expressArray);return path[0]};function mountComponent(target,Component,module){var component=new Component;var observeFunction=function observeFunction(){if(isFunction(component.$beforeUpdate))component.$beforeUpdate();var _iterator=_createForOfIteratorHelper(component.__directives),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var directiveInstance=_step.value;if(isFunction(directiveInstance.instance.$update)){directiveInstance.instance.$update(directiveInstance.el,{type:directiveInstance.type,exp:directiveInstance.exp,value:evalExpress(component,directiveInstance.exp),target:component})}}}catch(err){_iterator.e(err)}finally{_iterator.f()}if(isFunction(component.$updated))component.$updated()};if(isFunction(component.$setup)){var instance=component.$setup();for(var key in instance){isValidKey(key);if(instance[key].type=="ref"){watcher(component,instance[key],key,observeFunction)}else if(instance[key].type=="reactive"){proxy(component,instance[key],key,observeFunction)}else if(isFunction(instance[key])){component[key]=instance[key]}}}component.__children=[];component.__directives=[];var templateObj=component.__template__;(function createElement(index,pEl){var vnode=templateObj[index],el=null;if(vnode.type=="tag"){if(vnode.name in module.__component__){component.__children.push(mountComponent(pEl,module.__component__[vnode.name],module))}else{el=document.createElement(vnode.name);for(var attrKey in vnode.attrs){var attrKeys=(attrKey+":").split(":");if(attrKeys[0]in module.__directive__){(function(){var directiveInstance=new module.__directive__[attrKeys[0]];var type=attrKeys[1];var exp=vnode.attrs[attrKey];if(isFunction(directiveInstance.$inserted)){setTimeout((function(){directiveInstance.$inserted(el,{type:type,exp:exp,value:evalExpress(component,exp),target:component})}))}component.__directives.push({instance:directiveInstance,el:el,type:type,exp:exp})})()}else{el.setAttribute(attrKey,vnode.attrs[attrKey])}}if(component.__uniqueId__!=null){el.setAttribute(component.__uniqueId__,"")}var _iterator2=_createForOfIteratorHelper(vnode.childNodes),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var subVnode=_step2.value;createElement(subVnode,el)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}else if(vnode.type=="text"){el=document.createTextNode("");el.textContent=vnode.content.replace(/‚Üµ/g,"\n")}if(el!=null){pEl.appendChild(el)}})(0,target);if(isFunction(component.$mounted))component.$mounted();return component}function platform(options){addStylesClient(options.styles||[]);var rootComponent=null;return{bootstrap:function bootstrap(Module){var module=new Module;var allList=_objectSpread2(_objectSpread2({},module.__component__),module.__directive__);for(var key in allList){allList[key].prototype._module=module}rootComponent=mountComponent(options.el,module.__bootstrapComponent__,module);return{rootComponent:rootComponent,module:module}}}}function ref(data){return{value:data,type:"ref"}}function reactive(data){if(isObject(data)){return{value:data,type:"reactive"}}else{return ref(data)}}var Nefbl={Module:Module,Component:Component,Directive:Directive,platform:platform,mountComponent:mountComponent,evalExpress:evalExpress,ref:ref,reactive:reactive};if((typeof module==="undefined"?"undefined":_typeof(module))==="object"&&_typeof(module.exports)==="object"){module.exports=Nefbl}else{window.Nefbl=Nefbl}})();