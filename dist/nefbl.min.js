/*!
 * nefbl - Êñ∞‰∏Ä‰ª£ÂâçÁ´ØÊ°ÜÊû∂
 *
 * git+https://github.com/nefbl/nefbl.git
 *
 * author ‰Ω†Â•Ω2007 < https://hai2007.gitee.io/sweethome >
 *
 * version 0.1.0-alpha.1
 *
 * Copyright (c) 2021-2021 hai2007 Ëµ∞‰∏ÄÊ≠•ÔºåÂÜçËµ∞‰∏ÄÊ≠•„ÄÇ
 * Released under the MIT license
 *
 * Date:Tue Sep 21 2021 13:38:45 GMT+0800 (‰∏≠ÂõΩÊ†áÂáÜÊó∂Èó¥)
 */
(function(){"use strict";function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function(obj){return typeof obj}}else{_typeof=function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function Module(config){return function(target){}}var $RegExp={blankReg:new RegExp("[\\x20\\t\\r\\n\\f]"),blanksReg:/^[\x20\t\r\n\f]{0,}$/,identifier:/^[a-zA-Z_$][0-9a-zA-Z_$]{0,}$/};var toString=Object.prototype.toString;function getType(value){if(value==null){return value===undefined?"[object Undefined]":"[object Null]"}return toString.call(value)}function _isString(value){var type=_typeof(value);return type==="string"||type==="object"&&value!=null&&!Array.isArray(value)&&getType(value)==="[object String]"}var isString=_isString;function analyseTag(attrString){var attr={},index=0;attrString=attrString.trim();var getOneAttr=function getOneAttr(){var attrName="",attrValue="";for(;index<attrString.length;index++){if($RegExp.blanksReg.test(attrString[index])||index==attrString.length-1){attrName+=attrString[index];if(!$RegExp.blanksReg.test(attrName)){attr[attrName.trim()]=""}index+=1;break}else if(attrString[index]=="="){index+=1;var preCode=null,preLeng=-1;if(attrString.substr(index,1)=='"'||attrString.substr(index,1)=="'"){preCode=attrString.substr(index,1);preLeng=1;index+=1}else if(attrString.substr(index,2)=='"'||attrString.substr(index,2)=="'"){preCode=attrString.substr(index,2);preLeng=2;index+=2}if(preCode!==null){for(;index<attrString.length;index++){if(attrString.substr(index,preLeng)==preCode){attr[attrName.trim()]=attrValue.trim();index+=2;break}else{attrValue+=attrString[index]}}}else{for(;index<attrString.length;index++){if($RegExp.blanksReg.test(attrString[index])){attr[attrName.trim()]=attrValue.trim();index+=1;break}else{attrValue+=attrString[index]}}}break}else{attrName+=attrString[index]}}if(index<attrString.length){getOneAttr()}};getOneAttr();return attr}function nextTagFun(template){var i=-1,currentChar=null;var preIsSpecial=false,specialCode="";var specialTag=["script","pre","style","code"];var next=function next(){currentChar=i++<template.length-1?template[i]:null;return currentChar};var nextNValue=function nextNValue(n){return template.substring(i,n+i>template.length?template.length:n+i)};next();while($RegExp.blankReg.test(currentChar)&&i<template.length-1){next()}return function(){var tag=currentChar,tagObj={};if(tag==null)return null;if(preIsSpecial){tagObj.type="textcode";tagObj.tagName=tag;while(nextNValue(specialCode.length+3)!="</"+specialCode+">"&&i<template.length){tagObj.tagName+=next()}tagObj.tagName=tagObj.tagName.replace(/<$/,"");preIsSpecial=false;return tagObj}if(nextNValue(4)=="\x3c!--"){tagObj.type="comment";tagObj.tagName=tag;while(nextNValue(3)!="--\x3e"&&i<template.length){tagObj.tagName+=next()}next();next();next();tagObj.tagName=tagObj.tagName.replace(/^<!--/,"").replace(/-$/,"");return tagObj}if(nextNValue(9)=="<!DOCTYPE"){tagObj.type="DOCTYPE";tagObj.tagName=tag;while(nextNValue(1)!=">"&&i<template.length){tagObj.tagName+=next()}next();tagObj.tagName=tagObj.tagName.replace(/^<!DOCTYPE/,"").replace(/>$/,"");return tagObj}else if(tag=="<"){var isAttrString=false,attrLeftValue=null,attrLeftLen=null;while((isAttrString||currentChar!=">")&&i<template.length){tag+=next();if(isAttrString){var next23Value=nextNValue(attrLeftLen+1).substring(1);if(next23Value==attrLeftValue){isAttrString=false}}else{var next23Value=nextNValue(2);if(next23Value=='="'||next23Value=="='"){attrLeftValue=next23Value.replace("=","");attrLeftLen=1;isAttrString=true}next23Value=nextNValue(3);if(next23Value=='="'||next23Value=="='"){attrLeftValue=next23Value.replace("=","");attrLeftLen=2;isAttrString=true}}}if(/^<\//.test(tag)){tagObj.tagName=tag.replace(/^<\//,"").replace(/>$/,"");tagObj.type="endTag"}else{if(/\/>$/.test(tag)){tagObj.type="fullTag";tag=tag.replace(/\/>$/,"")}else{tagObj.type="beginTag";tag=tag.replace(/>$/,"")}tag=tag.replace(/^</,"");tagObj.tagName="";var j=0;for(;j<tag.length;j++){if(tag[j]==" ")break;tagObj.tagName+=tag[j]}var attrString=tag.substring(j);if($RegExp.blanksReg.test(attrString)){tagObj.attrs={}}else{tagObj.attrs=analyseTag(attrString)}}}else{tagObj.type="textcode";tagObj.tagName=currentChar;while(nextNValue(1)!="<"&&i<template.length){tagObj.tagName+=next()}tagObj.tagName=tagObj.tagName.replace(/<$/,"");i-=1}if(tagObj.type=="beginTag"){if(specialTag.indexOf(tagObj.tagName.toLowerCase())>-1){preIsSpecial=true;specialCode=tagObj.tagName}}else if(tagObj.type=="endTag"){if(specialTag.indexOf(tagObj.tagName.toLowerCase())>-1){preIsSpecial=false}}next();return tagObj}}function analyseDeep(tagArray){tagArray=closeTag(tagArray);var deep=0,tagDeepArray=[];tagArray.forEach((function(tag){if(tag.type=="beginTag"){tagDeepArray.push({type:"tag",name:tag.tagName,attrs:tag.attrs,__deep__:++deep,__tagType__:"double"})}else if(tag.type=="endTag"){deep-=1}else if(tag.type=="textcode"){tagDeepArray.push({type:"text",content:tag.tagName,__deep__:deep+1})}else if(tag.type=="comment"){tagDeepArray.push({type:"comment",content:tag.tagName,__deep__:deep+1})}else{tagDeepArray.push({type:"tag",name:tag.tagName,attrs:tag.attrs,__deep__:deep+1,__tagType__:"single"})}}));return tagDeepArray}var closeTag=function closeTag(tagArray){var needClose=[];tagArray.forEach((function(tag,i){if(tag.type=="beginTag"){needClose.push([i,tag.tagName])}else if(tag.type=="endTag"){while(needClose.length>0){var needCloseTag=needClose.pop();if(needCloseTag[1]==tag.tagName){break}else{tagArray[needCloseTag[0]].type="fullTag"}}}}));return tagArray};
/*!
   * üî™ - Ëß£Êûêxhtml‰∏∫jsonÂØπË±°ËøîÂõû
   * https://github.com/hai2007/algorithm.js/blob/master/xhtmlToJson.js
   *
   * author hai2007 < https://hai2007.gitee.io/sweethome >
   *
   * Copyright (c) 2020-present hai2007 Ëµ∞‰∏ÄÊ≠•ÔºåÂÜçËµ∞‰∏ÄÊ≠•„ÄÇ
   * Released under the MIT license
   */function xhtmlToJson(template,noIgnore){if(!isString(template))throw new Error("Template must be a String!");var nextTag=nextTagFun(template.trim());var tag=nextTag(),DomTree=[];while(tag!=null){if(tag.type=="textcode"&&$RegExp.blanksReg.test(tag.tagName));else if(tag.type=="DOCTYPE");else if(tag.type=="comment"){if(noIgnore){DomTree.push(tag)}}else{DomTree.push(tag)}tag=nextTag()}DomTree=analyseDeep(DomTree);var presNode=[null],preDeep=0;for(var i=0;i<DomTree.length;i++){var currentIndex=i,currentDeep=DomTree[i].__deep__;DomTree[i].childNodes=[];DomTree[i].preNode=null;DomTree[i].nextNode=null;var lastPre=presNode[presNode.length-1];var last2Pre=presNode.length>1?presNode[presNode.length-2]:null;if(currentDeep==preDeep){DomTree[currentIndex].preNode=lastPre;DomTree[lastPre].nextNode=currentIndex;DomTree[currentIndex].parentNode=last2Pre;DomTree[last2Pre].childNodes.push(currentIndex);presNode[presNode.length-1]=currentIndex}else if(currentDeep>preDeep){DomTree[currentIndex].parentNode=lastPre;if(lastPre!=null)DomTree[lastPre].childNodes.push(currentIndex);presNode.push(currentIndex)}else{var preTempIndex=presNode[presNode.length-1-(preDeep-currentDeep)];var preTemp2Index=presNode[presNode.length-2-(preDeep-currentDeep)];DomTree[currentIndex].preNode=preTempIndex;if(preTempIndex!=null)DomTree[preTempIndex].nextNode=currentIndex;DomTree[currentIndex].parentNode=preTemp2Index;if(preTemp2Index!=null)DomTree[preTemp2Index].childNodes.push(currentIndex);for(var j=0;j<preDeep-currentDeep;j++){presNode.pop()}presNode[presNode.length-1]=currentIndex}preDeep=currentDeep}return DomTree}function Component(config){var template=xhtmlToJson(config.template);return function(target){}}function platform(options){return{bootstrap:function bootstrap(module){}}}var Nefbl={Module:Module,Component:Component,platform:platform};if((typeof module==="undefined"?"undefined":_typeof(module))==="object"&&_typeof(module.exports)==="object"){module.exports=Nefbl}else{window.Nefbl=Nefbl}})();